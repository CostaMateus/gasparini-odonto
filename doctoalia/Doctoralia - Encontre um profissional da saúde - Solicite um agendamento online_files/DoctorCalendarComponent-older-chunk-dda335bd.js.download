(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{K4fC:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r("fJoI"),n=r("pd48");function s(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"fetchDoctorAddressSlots",value:function(e,t,r,s){var o={start:Object(n.a)(t),end:Object(n.a)(r),"with-slot-details":!0,saasonly:s};return Object(a.a)({url:"/ajax/doctor/slots/".concat(e),method:"get",params:o})}},{key:"fetchFacilitySlots",value:function(e,t,r,n,s,o){return Object(a.a)({url:"/api/v3/facilities/".concat(e,"/addresses/").concat(t,"/slots"),method:"get",params:{with:["facility_address.nearest_slot_after_end","links.book.patient","slot.doctor_id","slot.address_id"],filters:s||{},start:r,end:n,includingSaasOnlyCalendars:o}})}}],(r=null)&&s(t.prototype,r),o&&s(t,o),e}()},V2QU:function(e,t,r){"use strict";r.r(t);var a=r("Wgwc"),n=r.n(a),s=r("Ppn1"),o=r("K4fC"),i=r("KNFO"),l=r("R6JH"),d=r("LHKR"),c=r("4GhJ");function u(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}var f={name:"DoctorCalendar",components:{CalendarWrapper:function(){return r.e(21).then(r.bind(null,"Xsvn"))}},props:{addressId:{type:String,required:!0},resultId:{type:String,required:!0},url:{required:!1,type:String,default:""},initialRowsValue:{required:!1,type:Number,default:4},addressIsVisible:{required:!1,type:Boolean,default:!1},showAllSlots:{required:!1,type:Boolean,default:!1},isOnlineOnly:{required:!1,type:Boolean,default:!1}},data:function(){return{period:{startDate:n()().startOf("day"),endDate:n()().endOf("day").add(i.b,"day")},calendarSlotsItems:[],nearestSlot:"",calendarState:s.g.off,calendarId:null,slotsLoaded:!1,addressState:""}},computed:{redirectURL:function(){return this.calendarState===s.g.overbooked&&this.calendarId?"".concat(this.url,"#highlight-calendar-").concat(this.calendarId,"&slot-realising-modal"):"".concat(this.url,"#address-id=[").concat(this.addressId,"]")},freeSlots:function(){return this.calendarSlotsItems.filter((function(e){return!1===e.booked}))},hasFreeSlots:function(){return this.freeSlots.length>0},isLoadingStatus:function(){return!this.slotsLoaded}},watch:{addressIsVisible:{immediate:!0,handler:function(e){!0!==e||this.slotsLoaded||this.loadCalendarSlots()}}},methods:{loadCalendarSlots:function(e){var t,r=this;return(t=regeneratorRuntime.mark((function t(){var a,s,d,u,f,p,h,b,v,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&(r.period=e),t.prev=1,t.next=4,o.a.fetchDoctorAddressSlots(r.addressId,r.period.startDate,r.period.endDate);case 4:a=t.sent,s=a.items,d=a.nearest,u=a.calendarStatus,f=a.calendarId,p=a.addressState,r.calendarId=f,r.addressState=p,r.calendarSlotsItems=r.calendarSlotsItems.concat(s),0!==d.length?r.nearestSlot=d.start:r.hasFreeSlots&&(h=n()(r.freeSlots[r.freeSlots.length-1].start).endOf("day"),""!==r.nearestSlot?r.period.endDate=h:(b=h.diff(r.period.startDate,"day")+1,v=Math.ceil(b/i.b),y=v*i.b-b,r.period.endDate=n()(h).add(y,"day"))),r.mapCalendarStatus(u),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),Object(l.a)(t.t0,.1);case 16:return t.prev=16,r.slotsLoaded=!0,Object(c.a)("CALENDAR_RENDERED",document),t.finish(16);case 20:case"end":return t.stop()}}),t,null,[[1,13,16,20]])})),function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function o(e){u(s,a,n,o,i,"next",e)}function i(e){u(s,a,n,o,i,"throw",e)}o(void 0)}))})()},mapCalendarStatus:function(e){e&&e!==d.e&&(e!==d.c||!this.hasFreeSlots&&""===this.nearestSlot?this.calendarState=s.g.overbooked:this.calendarState=s.g.available)}}},p=r("KHd+"),h=Object(p.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.addressIsVisible?r("div",[r("calendar-wrapper",{attrs:{"address-state":e.addressState,"calendar-slots-items":e.calendarSlotsItems,"calendar-state":e.calendarState,"ga-category":"NS Doctor Card","is-loading-status":e.isLoadingStatus,"is-online-only":e.isOnlineOnly,"nearest-slot":e.nearestSlot,period:e.period,"redirect-url":e.redirectURL,"result-id":e.resultId,"rows-value":e.initialRowsValue,"show-all-slots":e.showAllSlots},on:{"load-more-slots":e.loadCalendarSlots}})],1):e._e()}),[],!1,null,null,null);t.default=h.exports},fJoI:function(e,t,r){"use strict";var a=r("bKGl"),n=r("XiPH"),s=r("Qyje"),o=r.n(s),i=r("8dGq"),l=r("uEvc");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t,r,a,n,s,o){try{var i=e[s](o),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(a,n)}function p(){var e;return e=regeneratorRuntime.mark((function e(t,r){var s,d,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.paramsSerializer=function(e){return o.a.stringify(e,{arrayFormat:"brackets"})},e.prev=1,s=i.a.axios){e.next=5;break}return e.abrupt("return",Promise.reject(new Error("You have to setup axios before using it.")));case 5:return e.next=7,s(t);case 7:if(d=e.sent,u=Object(a.camelizeKeys)(d.data),void 0!==r){e.next=11;break}return e.abrupt("return",u);case 11:return e.abrupt("return",c({},Object(n.b)(u,r)));case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",Promise.reject(l.a.getAxiosError(e.t0)));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})),(p=function(){var t=this,r=arguments;return new Promise((function(a,n){var s=e.apply(t,r);function o(e){f(s,a,n,o,i,"next",e)}function i(e){f(s,a,n,o,i,"throw",e)}o(void 0)}))}).apply(this,arguments)}t.a=function(e,t){return p.apply(this,arguments)}},pd48:function(e,t,r){"use strict";var a=r("Wgwc"),n=r.n(a);t.a=function(e){if(!n()(e).isValid())throw new Error("Provided `date` is not valid");return n()(e).format().slice(0,19)}}}]);